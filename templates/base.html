<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kimhut Café</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<header class="topbar">
  <div class="brand">KimhutCaf&eacute;</div>
  <button class="nav-toggle" id="navToggle" aria-label="Toggle menu" aria-expanded="false">☰</button>
  <!-- Nav links -->
  <nav id="siteNav" class="nav">
    <a href="{{ url_for('home') }}">Home</a>
{#    <a href="{{ url_for('products') }}">Menu</a>#}
  <div class="nav-item has-dropdown">
  <a href="{{ url_for('products') }}" class="nav-link">Menu</a>
      <div class="dropdown">
        <a href="{{ url_for('products') }}"
           class="{{ 'active' if selected_nav_category|lower == 'all' else '' }}">All</a>
        {% for c in categories_nav %}
          <a href="{{ url_for('products', category=c) }}"
             class="{{ 'active' if selected_nav_category|lower == c|lower else '' }}">{{ c }}</a>
        {% endfor %}
      </div>
    </div>

    <a href="{{ url_for('about') }}">About Us</a>
    <a href="{{ url_for('contact') }}">Contact</a>
      <a href="{{ url_for('cart') }}" class="cart-link">
          Cart
          {% if cart_count %}
            <span class="badge" aria-label="{{ cart_count }} items">{{ cart_count }}</span>
          {% endif %}
      </a>

  <form class="nav-search" action="{{ url_for('products') }}" method="get" role="search" aria-label="Search menu">
  <input type="text" name="q" value="{{ search_q }}" placeholder="Search menu…">
  <button class="btn" type="submit">Search</button>
</form>

  </nav>
</header>

<main class="container">
  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash">
      {% for cat, msg in messages %}
        <div class="flash-item">{{ msg }}</div>
      {% endfor %}
    </div>
  {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</main>
<footer class="site-footer" role="contentinfo">
    <div class="footer-inner">
    <!-- Brand / intro -->
    <div class="footer-col">
      <h4>Kimhut Café</h4>
      <p>Fresh coffee & comfort bites. Scan & pay via <strong>KHQR</strong> — in <strong>USD</strong> or <strong>KHR</strong>.</p>
      <div class="pay-badges" aria-label="Supported payments">
        <span class="badge">KHQR</span>
        <span class="badge">USD</span>
        <span class="badge">KHR</span>
      </div>
    </div>

    <!-- Quick links -->
    <nav class="footer-col" aria-label="Quick links">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="{{ url_for('home') }}">Home</a></li>
        <li><a href="{{ url_for('products') }}">Menu</a></li>
        <li><a href="{{ url_for('about') }}">About Us</a></li>
        <li><a href="{{ url_for('contact') }}">Contact</a></li>
        <li><a href="{{ url_for('cart') }}">Cart ({{ cart_count or 0 }})</a></li>
      </ul>
    </nav>

    <!-- Contact / location -->
    <div class="footer-col">
      <h4>Contact</h4>
      <ul>
        <li>Phnom Penh, Cambodia</li>
        <li>Phone: <a href="tel:+855888356210">+855 888 356 210</a></li>
        <li>Email: <a href="mailto:{{ config.get('MAIL_DEFAULT_SENDER','orders@example.com') }}">
          {{ config.get('MAIL_DEFAULT_SENDER','orders@example.com') }}</a></li>
      </ul>
    </div>

    <!-- Hours -->
    <div class="footer-col">
      <h4>Opening Hours</h4>
      <ul>
        <li>Mon–Fri: 7:30 – 20:30</li>
        <li>Sat–Sun: 8:00 – 20:00</li>
        <li>Public holidays: Call ahead</li>
      </ul>
    </div>
  </div>

  <div class="footer-bottom">
    © <span id="year"></span> Kimhut Café · Built by sothun
    <a class="to-top" href="#" aria-label="Back to top">↑ Top</a>
  </div>

  <script>
    // Auto year + smooth scroll to top
    (function(){
      const y = document.getElementById('year');
      if (y) y.textContent = new Date().getFullYear();
      document.querySelector('.to-top')?.addEventListener('click', (e)=>{
        e.preventDefault();
        window.scrollTo({top:0, behavior:'smooth'});
      });
    })();
  </script>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('navToggle');
  const nav = document.getElementById('siteNav');

  // Hamburger open/close
  if (btn && nav) {
    btn.addEventListener('click', () => {
      const open = nav.classList.toggle('open');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
    });

    // Close after clicking a link, EXCEPT the Menu header on mobile
    nav.querySelectorAll('a').forEach(a => {
      a.addEventListener('click', (e) => {
        const isDropdownHeader = a.classList.contains('nav-link') && a.closest('.has-dropdown');
        if (isDropdownHeader) return; // allow the dropdown to open, don't close the nav
        if (nav.classList.contains('open')) {
          nav.classList.remove('open');
          btn.setAttribute('aria-expanded', 'false');
        }
      });
    });
  }

  // Toggle Menu dropdown on mobile only
  document.querySelectorAll('.has-dropdown > .nav-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const isMobile = window.matchMedia('(max-width: 768px)').matches;
      if (isMobile) {
        e.preventDefault();
        link.parentElement.classList.toggle('open');
      }
    });
  });
});
</script>

</body>
</html>
